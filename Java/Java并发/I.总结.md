# 并发的理解与汇总

## 并发编程的挑战
并发编程的目的是为了让程序运行的更快，期间会面临着非常多的挑战：  

+ 上下文切换
   减少上下文切换的方法有：**无锁并发编程**、**CAS算法**、**使用最少线程**和 **使用协程**。
+ 死锁  
   避免死锁的常见方法：  
    - 避免一个线程同时获取多个锁
    - 避免一个线程同时占用多个资源，尽量保证每个锁只占用一个资源
    - 尝试使用定时锁
    - 对于数据库锁，加锁和解锁必须在一个数据库连接中
+ 硬件和软件的资源限制

## 并发机制的底层实现原理

volatile变量
--- 

Java语言规范对volatile的定义：Java编程语言允许线程访问共享变量，为了确保共享变量被准确和一致地更新，线程应该确保通过排他锁单独获得这个变量。  

volatile变量修饰共享变量进行写操作时会插入Lock前缀的汇编指令。实现原则： 

+ Lock前缀指令会引起处理器缓存回写到内存。
+ 一个处理器的缓存回写到内存会导致其他处理器的缓存无效。

synchronized
---

利用`synchronized`实现同步的基础：Java中的每个对象都可以作为锁。  

JVM基于进入和退出Monitor对象来实现方法同步和代码块同步，其中代码块同步使用`monitorenter`和`monitorexit`指令实现的，而方法同步使用的其他未明示的方式实现。`monitorenter`指令在编译后插入到同步代码块的开始位置，而`monitorexit`插入到方法结束处和异常处。  



原子操作
---

